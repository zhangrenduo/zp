$(function(){$("#popkeyword").focus(function(){showPop()});$("#canclepop,#shadow").click(function(){if($("#loginpop").css("display")!="block"){$("#searchpop,#shadow").hide();$("#popkeyword").val($("#keyword").val());ModalHelper.popHide()}});$("#hotrecom a").click(function(){var a=$(this).html();keysearch(a)});$("#keyword").bind("input",function(){assocKeyword()})});var showPop=function(){ModalHelper.popShow();$("#assoc").hide();var d=storage.json_get("jcsearch_log");if(d){$("#searchpop,#search_con,#shadow,#history,#hotmq").show();var a=d.log;var b="";var c=new RegExp("'","g");a.reverse();for(key in a){if(key<3){b+='<li><a tracetag="MIDUODUO_INDEX_HISTORYSEARCH" onclick="keysearch(\''+a[key].name+"',this);\">"+a[key].name+"</a></li>"}}$("#history .box").empty().append(b)}else{$("#searchpop,#search_con,#shadow,#hotrecom,#hotmq").show()}if($.trim($("#keyword").val())!=""){assocKeyword()}$("#keyword").focus()};var kwdSearchDatas=[];var assocKeyword=function(){$("#history,#hotrecom,#hotmq").hide();$("#assoc").show();var a="//kwdsrv.51job.com/KwdSrvByKey/default.aspx?";var b=escape($.trim($("#keyword").val()));var a=a+"src=51joball&kwd="+b+"&callback=?";if(b==""){showPop();return false}$.getJSON(a,function(c){if("1"==c.message){if(""!=c.content){kwdSearchDatas[b]=unescape(c.content).split("\t")}else{kwdSearchDatas[b]=""}}$("#assoc").children().remove();kwdAssocShow(kwdSearchDatas[b])})};var kwdAssocShow=function(a){var e="";if(typeof(a)==="undefined"||a==""){$("#assoc").hide()}else{var d=new RegExp("'","g");var c=0;var b=$("#keyword").val();if(typeof(a)!="undefined"){$.each(a,function(g,f){g++;if(g<=10){e+='<a class="e e1 at" tracetag="MIDUODUO_INDEX_ASSOCSEARCH" onclick="keysearch(\''+f.replace(d,"\\'")+"',this);\" >"+f.replace(b,"<span>"+b+"</span>")+"</a>"}})}$("#assoc").append(e)}};var checkForm=function(){if($.trim($("#keyword").val())!=""){var b="MIDUODUO_INDEX_INPUTSEARCH";var a=$_CONFIG.domain+"/ajax/my/writelog.ajax.php?jsoncallback=?&tracetag="+b;$.getJSON(a);keysearch($("#keyword").val())}else{$("#searchpop,#shadow").hide();pop.ini({msg:"请输关键字"},{title:"确定"});return false}};var keysearch=function(a,h){var e=a;if($.trim(e)==""){$("#searchpop,#shadow").hide();pop.ini({msg:"请输关键字"},{title:"确定"});return false}$("input[name='keyword']").val(e);var c=storage.json_get("jcsearch_log");var b={name:e};if(c==""){var f=new Array();f.push(b);storage.json_set("jcsearch_log",{log:f})}else{var f=c.log;var d=new Array();for(key in f){d.push(f[key].name)}if($.inArray(e,d)=="-1"){if(f.length>=3){f.shift();f.push(b);storage.json_set("jcsearch_log",{log:f})}else{f.push(b);storage.json_set("jcsearch_log",{log:f})}}else{for(key in d){if(d[key]==e){f.splice(key,1)}}f.push(b);storage.json_set("jcsearch_log",{log:f})}}var i=$(h).attr("tracetag");if(i){var g=$_CONFIG.domain+"/ajax/my/writelog.ajax.php?jsoncallback=?&tracetag="+i;$.getJSON(g)}location.href=$_CONFIG.domain_s+"/job/joblist?keyword="+encodeURIComponent($.trim(e));return false};function bodyScroll(b){b.preventDefault()}var ModalHelper=(function(d){var c;return{popShow:function(){c=$(window).scrollTop();$("body").addClass(d).css("top",-c+"px");$(".btmtab, .ydgz").css("position","absolute");$("#shadow").show().on("touchmove",bodyScroll,false);document.body.addEventListener("touchmove",bodyScroll,{passive:false})},popHide:function(){$("body").removeClass(d).css("top","");$(window).scrollTop(c);$(".btmtab").css("position","fixed");$(".ydgz, .ydgz").css("position","fixed");$("#shadow").hide().off("touchmove",bodyScroll,false);document.body.removeEventListener("touchmove",bodyScroll,{passive:false})}}})("modal-open");